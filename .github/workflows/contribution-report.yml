name: Generate Contribution Report

on:
  workflow_run:
    workflows: ["Some Other Workflow"]
    types:
      - completed
  schedule:
    - cron: '0 16 * * 5'  # Run every Friday at 4 PM EST

jobs:
  generate_report:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout repository
        uses: actions/checkout@v2

      - name: Set up Python
        uses: actions/setup-python@v2
        with:
          python-version: '3.9'

      - name: Create reports directory
        run: |
          mkdir -p reports  # Creates the reports directory if it doesn't exist

      - name: Generate contribution report
        run: |
          today=$(date +"%Y-%m-%d")
          report_file="reports/contributions_${today}.md"
          
          # Initialize counters for each category
          issues_opened=4
          prs_opened=3
          reviews_requested=2

          # Generate the report content with totals and emojis
          echo "# Contribution Report for ${today}" > $report_file
          echo "## Summary of Contributions" >> $report_file
          echo "### Issues Opened (${issues_opened}):" >> $report_file
          echo "  - Example Issue 1" >> $report_file
          echo "  - Example Issue 2" >> $report_file
          echo "  - Example Issue 3" >> $report_file
          echo "  - Example Issue 4" >> $report_file
          echo "### ðŸ“„ Pull Requests Opened (${prs_opened}):" >> $report_file
          echo "  - Example PR 1" >> $report_file
          echo "  - Example PR 2" >> $report_file
          echo "  - Example PR 3" >> $report_file
          echo "### ðŸ‘€ PR Reviews Requested (${reviews_requested}):" >> $report_file
          echo "  - Example Review 1" >> $report_file
          echo "  - Example Review 2" >> $report_file

          # Commit the report to the repository
          git add $report_file
          git config --global user.name "GitHub Action"
          git config --global user.email "action@github.com"
          git commit -m "Generate contribution report for ${today}"
          git push origin main
        env:
          GITHUB_TOKEN: ${{ secrets.WEEKLY_TOKEN }}
